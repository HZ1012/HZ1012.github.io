---
layout:     post                    # 使用的布局（不需要改）
title:      统计建模（3）            # 标题 
subtitle:   生存分析基础、考克斯比例风险 #副标题
date:       2022-02-26              # 时间
author:     HZ                      # 作者
header-img: img/pca.png    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - 统计学习
    - 数学建模
---

>本文适用于对主成分分析知识有一定了解的读者，以算法介绍和应用为主

简介：主成分分析是将多指标化为少数几个综合指标的一种统计分析方法，在实际问题中，研究多指标的问题是经常遇到的问题，多元统计分析处理的是多变量问题。由于变量数量太多，并且彼此之间存在着一定的相关性，因而使得所观测到的数据在一定程度上反应信息有所重叠。
而且当变量较多时，高维空间中研究样本规律较为复杂，势必增加分析问题的复杂性。人们希望利用较少的综合变量来代替原有的较多变量；而这几个综合变量又能尽可能多的反映原来变量的信息，并且彼此之间互不相关。利用这种降维的思想，产生了主成分分析等统计方法。

### 经典方法
#### [PCA - 主成分分析](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/)，用于分析包含连续变量的数据集

主成分分析 (PCA) 使我们能够总结和可视化数据集中的信息，该数据集中包含由多个相互关联的定量变量描述的个人/观察结果。 每个变量都可以被视为不同的维度。 如果您的数据集中有 3 个以上的变量，则可能很难可视化多维超空间。

主成分分析用于从多元数据表中提取重要信息，并将此信息表示为一组称为主成分的少数新变量。 这些新变量对应于原始变量的线性组合。 主成分数小于或等于原始变量数。

给定数据集中的信息对应于它包含的总变异。  PCA 的目标是确定数据变化最大的方向（或主成分）。

换句话说，PCA 将多变量数据的维数减少到两个或三个主成分，这些主成分可以用图形方式可视化，信息损失最小。

如图 3.1 所示，此处使用的数据描述了运动员在两项体育赛事（Desctar 和 OlympicG）中的表现。 它包含由 13 个变量描述的 27 个人（运动员）。

![NeatReader-1631176091158](数模整理.assets/NeatReader-1631176091158.png)

请注意，只有其中一些个体和变量将用于执行主成分分析。 因子图上剩余个体和变量的坐标将在 PCA 之后进行预测。

### [CA - 对应分析](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-essentials/)，用于分析两个分类变量之间的关联。

对应分析 (CA) 是主成分分析的扩展，适用于探索定性变量（或分类数据）之间的关系。 与主成分分析一样，它提供了一种在二维图中汇总和可视化数据集的解决方案。

在这里，我们描述简单对应分析，它用于分析由两个分类数据形成的频率，一个数据表称为列联表。 它为列联表的行和列点提供因子分数（坐标）。 这些坐标用于以图形方式可视化列联表中行和列元素之间的关联。

 在分析双向列联表时，一个典型的问题是某些行元素是否与列元素的某些元素相关联。 对应分析是一种将双向列联表的行列可视化为低维空间中的点的几何方法，使得行列点的位置与其在表中的关联一致。 目的是对有助于解释的数据有一个全局视图。

在当前章节中，我们将展示如何使用两个 R 包计算和解释对应分析：i）用于分析的 FactoMineR 和 ii）用于数据可视化的 factoextra。 此外，我们将展示如何揭示解释数据集中变化的最重要变量。 我们继续解释如何使用补充行和列应用对应分析。 如果您想使用 CA 进行预测，这很重要。 本指南的最后部分还描述了如何过滤 CA 结果以仅保留最重要的变量。 最后，我们将看到如何处理异常值。

代码示例见补充模型

数据是一个列联表，其中包含 13 个家庭任务及其在夫妻中的重新分配：行是不同的任务，值是完成任务的频率：由妻子或仅由丈夫或共同完成

![NeatReader-1631175936390](数模整理.assets/NeatReader-1631175936390.png)



### [MCA - 多重对应分析](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/114-mca-multiple-correspondence-analysis-in-r-essentials/)，用于分析包含 2 个以上分类变量的数据集。

多重对应分析 (MCA) 是简单对应分析（CA）的扩展，用于汇总和可视化包含两个以上分类变量的数据表。 当要分析的变量是分类变量而不是定量变量时，它也可以看作是主成分分析的概括（Abdi 和 Williams 2010）。

 MCA 通常用于分析调查中的数据集。 目标是确定：

*  一组在回答问题时具有相似特征的个体 
*  变量类别之间的关联 

之前，我们描述了如何计算和解释简单对应分析（第 5 章）。 在当前章节中，我们将演示如何使用 FactoMineR（用于分析）和 factoextra（用于数据可视化）在 R 软件中计算和可视化多重对应分析。 此外，我们将展示如何揭示对解释数据集中的变化贡献最大的最重要变量。 我们继续解释如何预测补充个体和变量的结果。 最后，我们将演示如何过滤 MCA 结果以仅保留贡献最大的变量。

示例代码见补充模型

数据包含 55 行（个人）和 15 列（变量）。 我们将仅使用其中一些个体（儿童）和变量来执行多重对应分析。 因子图上剩余个体和变量的坐标将根据之前的 MCA 结果进行预测。

### 高级方法

#### [FAMD - 混合数据的因子分析](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/115-famd-factor-analysis-of-mixed-data-in-r-essentials/)，用于分析包含定量和定性变量的数据集。

混合数据的因子分析 (FAMD) 是一种主成分方法，专门用于分析包含定量和定性变量的数据集 (J. Pages 2004)。 通过考虑混合类型的变量，可以分析个体之间的相似性。 此外，人们可以探索所有变量之间的关联，包括定量和定性变量。

粗略地说，FAMD 算法可以看作是主成分分析（PCA）和多重对应分析（MCA）的混合体。 换句话说，它充当 PCA 定量变量和定性变量的 MCA。
    

定量和定性变量在分析过程中被标准化，以平衡每组变量的影响。

代码示例见补充模型：分析葡萄酒的特征。（取子集）

前两列是因子（分类变量）：标签（Saumur、Bourgueil 或 Chinon）和土壤（reference、Env1、Env2 或 Env4）。其余列是数字（连续变量）。

#### [MFA - 多因素分析](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/116-mfa-multiple-factor-analysis-in-r-essentials/)

（J.Pagès 2002）是一种多变量数据分析方法，用于总结和可视化复杂数据表，其中个体由多组变量（定量和/或定性）组成。它考虑了所有活跃的变量组的贡献来定义个体之间的距离。

MFA 可被视为一般因素分析。 粗略地说，MFA 的核心基于：当变量为定量时，主成分分析，当变量为定性时，多重对应分析。

这种**同时考虑多组变量的全局分析需要平衡每组变量的影响**。 因此，在 MFA 中，变量在分析过程中被加权。 同一组中的变量使用相同的权重值进行标准化，这些权重值可能因一组而异。 从技术上讲，MFA 为组 j 的每个变量分配一个权重，该权重等于组 j 的分析（PCA 或 MCA，根据变量类型）的第一个特征值的倒数。

多因素分析可用于各种领域（J. Pages 2002），其中变量被组织成组： 

1. 调查分析，其中一个人是一个人； 变量是一个问题。 问题按主题（问题组）进行组织。

2. 感官分析，其中个人是食品。 第一组变量包括感官变量（甜味、苦味等）； 第二组包括化学变量（pH、葡萄糖率等）。

3. 生态学，其中一个人是一个观察场所。 第一组变量描述了土壤特征； 第二组描述植物群。

4. 时间序列，在不同的日期观察到几个人。 在这种情况下，通常有两种定义变量组的方法：

   通常，将同时（日期）观察到的变量聚集在一起。

   当变量从一个日期到其他日期都相同时，每个集合都可以为一个变量收集不同的日期。

  在当前章节中，我们将展示如何使用 FactoMineR（用于分析）和 factoextra（用于数据可视化）在 R 软件中计算和可视化多因素分析。 此外，我们将展示如何揭示对解释数据集中的变化贡献最大的最重要变量。

代码见R补充模型：**分析葡萄酒的特征**。


#### [ HCPC - 主成分的分层聚类](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/117-hcpc-hierarchical-clustering-on-principal-components-essentials/)

  目的：

  - 有一个包含连续变量的大型数据集时，可以在层次聚类分析之前使用主成分分析来降低数据的维数。
  - 有一个包含分类变量的数据集时，可以使用（多个）对应分析将分类变量转换为几个连续的主成分，这些主成分可以用作聚类分析的输入

  进一步进行数据挖掘，识别出相似对象的组

  一般执行PCA、CA、MCA、FAMD、MFA后再用

  算法：

  1. `Compute principal component methods`：PCA、(M)CA 或 MFA 取决于数据集中变量的类型和数据集的结构。在这一步，通过指定参数*ncp*来选择要在输出中保留的维数。默认值为 5。
  2. `Compute hierarchical clustering`：使用 Ward 标准对选定的主成分执行分层聚类。Ward 准则用于层次聚类，因为它基于多维方差，如主成分分析。
  3. `Choose the number of clusters based on the hierarchical tree`：通过切割分层树来执行初始分区。
  4. `Perform K-means clustering`改进从层次聚类获得的初始分区。
